\documentclass[11pt]{article}
\usepackage{listings}
\usepackage{hrefhide}
\title{Deep Learning Lab - Assignment 2}
\author{Francesco Saverio Zuppichini}
\lstset{
basicstyle=\ttfamily,
frame=single
}
\begin{document}
\maketitle
\section{Preambula}
Below there are a list of all the material I used in order to develop this project. 
\begin{itemize}
	\item Tutorial provided in the Deep Learning class slides
	\item \href{https://www.youtube.com/watch?v=vq2nnJ4g6N0}{Marting Görner talk and code}.
	\item \href{https://ikhlestov.github.io/pages/machine-learning/tensorflow-hints/}{Illarion Khlestov'blog}.
	\item Tensorflow source code, since the docs is incomplete sometimes.
	\item Some blog posts on medium, but lots of them where just wrong. 
 \end{itemize}
\section{Implementation}
All the code is open source and hosted on my GitHub \href{https://github.com/FrancescoSaverioZuppichini/LSTM-Text-Generator}{here}. You can check my commits to see when I started to work on it and how I managed to implement it.

We also provided a cli to quickly use the model, type \texttt{python3 main.py --help} in order to see the available options.
\subsection{Generate text}
The following snipper shows how to generate $500$ chars using 'TEST' as starting input from the $shakespeare$ model:
\begin{lstlisting}[breaklines=true]
python3 main.py --generate=True --from_model='shakespeare' --n_text=500 --start_text="TEST"	
\end{lstlisting}
\subsection{Train model}
If you wish to train it:
\begin{lstlisting}[breaklines=true]
python3 main.py --train=True --file='data/shakespeare'	
\end{lstlisting}
\section{Results}
Using three layers of $512$ neurons each with dropout, sequence length of $100$, batch size of $64$ and learning rate of $0.001$ we get the following results.
\subsection{Shakespeare}
I used Shakespare as text input in order to compare my work \href{https://www.youtube.com/watch?v=vq2nnJ4g6N0}{Marting Görner} and because I love theatre. The following text is generated by using \texttt{FRANCESCO}, my name, as starting text. \\
\begin{lstlisting}[breaklines=true]
FRANCESCO	The court of Lear, a strange man, and his soldiers
	that shows the pains to seem to straight at them.

LADY MACBETH	We have no more of that than this to-morrow.

CLOTEN	It is no man in this to make her beat him.
	The king's and this as much, to see him true.

CARDINAL WOLSEY	Wilt thou not stand, my lord? what say'st thou? then?

KING LEAR	If thou dost seek a song to the divinity,
	I had as lief be sunder'd. I am sorry
	That thou deservest to think that thou dost seem.

	[To KING LEAR]

	We are a merry tribunes, thou art dead.

Second Gentleman	What is't time?

Second Leap	To brave a bargain, and the book of the way.

CARDINAL WOLSEY	What seal'st he not a messenger? I hope
	We have no fortune to this strain and stand
	The sea till they are starter.

CARDINAL WOLSEY	This is a soul,
	To bring his power in the sea, till the best best
	Of this beloved man that should have stay'd,
	Which they are sorry in the sea that was
	As though in such a painter: that they are not
\end{lstlisting}\\
We generated $20$ files with $1000$ chars each, they can be found in \emph{./results/shakespeare}. We also generated a huge file of $50000$ chars, you can find it in \emph{./results/shakespeare/PROUD TO BE.txt}. It is a almost full play, take a look at it, it's very funny.

Unfortunately we were not able to use tensorboard on the cluster so we can not provide any useful plots, but \emph{./results/output-shakespeare.txt} shows the train loss and validation loss at each epoch.
\subsection{Bible}
I also trained my model with the Bible, since It was the first book big enough that comes in my mind. Starting with \texttt{01}, this is the result:
\begin{lstlisting}[breaklines=true]

  ^01And the Lord said unto Moses, Go into the land of Egypt the word
   of the Lord, that thou shalt say unto them, The Lord shall be the Gideanite
   of the Amorites, and the Amalekites.

   ^20And the Lord said unto Maccabeus, Thou shalt not be thy servant to
   say, Art thou a man that is a present that is in the house, and hast
   spoken this word to thy servants the king of Israel?

   ^11Then said Saul, The Lord hath set thee a sore and fourscore and two
   years old, and he shall bear the sea%	
\end{lstlisting}

\end{document}
